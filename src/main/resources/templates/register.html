<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">

<head th:include="include :: header">
    <script>if(window.top !== window.self){ window.top.location = window.location;}</script>
</head>

<body class="gray-bg">

<div class="middle-box text-center loginscreen   animated fadeInDown">
    <div>
        <div>

            <h1 class="logo-name">C-P</h1>

        </div>
        <h3>C-PLATFORM&nbsp;&nbsp;欢迎注册</h3>
        <p>创建一个新账户</p>
        <form class="m-t text-left" role="form" id="registerForm">
            <div class="form-group">
                <input type="text" class="form-control" placeholder="请输入用户名" required="" name="userName">
            </div>
            <div class="form-group">
                <input type="password" class="form-control" placeholder="请输入密码" required="" name="password">
            </div>
            <div class="form-group">
                <input type="password" class="form-control isPwdSame" placeholder="请再次输入密码" required="" name="password2">
            </div>
            <a onclick="register()" class="btn btn-primary block full-width m-b">注 册</a>

            <p class="text-muted text-center"><small>已经有账户了？</small><a href="login">点此登录</a>
            </p>

        </form>
    </div>
</div>
</body>

<div th:include="include :: footer"></div>
<script>
    $(document).ready(function(){$(".i-checks").iCheck({checkboxClass:"icheckbox_square-green",radioClass:"iradio_square-green",})});

    function register() {
        if($("#registerForm").valid()){
            var userName = $("input[name='userName']").val()
            var password = $("input[name='password']").val()
            var sendData = {
                userName: userName,
                password: password
            }
            $.ajax({
                type : "POST",
                url : "/sys-user/save",
                data: JSON.stringify(sendData),
                contentType: 'application/json;charset=UTF-8',
                error : function(request) {
                    swal({title:'网络超时',type:'error'})
                },
                success : function(data) {
                    if (data.resultCode == 0) {
                        swal({title:'注册成功',type:'success'})
                    } else {
                        swal({title:data.resultMsg,type:'error'})
                    }
                }
            });
        }
    }
    jQuery.validator.addMethod("isPwdSame",function(value,element){
        var pwd = $("input[name='password']").val()
        var pwd2 = $("input[name='password2']").val()
        if(pwd != pwd2){
            return false
        }else{
            return true
        }
    },"两次密码输入不一致");
</script>


</html>
